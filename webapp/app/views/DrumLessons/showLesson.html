#{extends 'academy.html' /}
#{set title:'lesson.name | Drum Lesson' /}
<hr class="soften" />

<div class="row">
	<div class="span3">
		<h1>${lesson.name}</h1>
	</div>
	<div class="offset10">
		<a href="@{DrumLessons.editLesson(lesson.id)}" class="btn">Edit</a>
	</div>
</div>
<p>Hosted with permission from <a href="http://www.drumlessons.com">drumlessons.com</a></p>
#{set 'moreScripts'}
		<script type="text/javascript">
		  // This specifies the location of the pdf.js file.
		  PDFJS.workerSrc = "/auth/public/javascripts/lib/pdf.js";
		</script>
		<script type="text/javascript">
		'use strict';
		PDFJS.getPdf('/auth/public/assets/pdfs/drumLessons/${lesson.pdfLocation}', function getPdfHelloWorld(data) {
		  //
		  // Instantiate PDFDoc with PDF data
		  //
		  var pdf = new PDFJS.PDFDoc(data);
		  var page = pdf.getPage(1);
		  var scale = 1.5;
		
		  //
		  // Prepare canvas using PDF page dimensions
		  //
		  var canvas = document.getElementById('the-canvas');
		  var context = canvas.getContext('2d');
		  canvas.height = page.height * scale;
		  canvas.width = page.width * scale;
		
		  //
		  // Render PDF page into canvas context
		  //
		  page.startRendering(context);
		});
	</script>
	
#{/set}

<div class="row">
	<div class="offset2">
		<iframe width="620" height="378" frameborder="0" 
			src="http://www.youtube.com/embed/${lesson.youtubeLocation}?modestbranding=1&rel=0&hl=en&fs=1&border=0&iv_load_policy=3&hd=1&showinfo=0" 
			type="text/html" class="youtube-player" title="YouTube video player"></iframe>
	</div>
</div>

<canvas id="the-canvas"></canvas>
<hr class="space" />